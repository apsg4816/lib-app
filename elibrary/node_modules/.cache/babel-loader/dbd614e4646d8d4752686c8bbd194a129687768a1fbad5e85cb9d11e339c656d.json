{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { onMounted, ref, computed } from 'vue';\nimport axios from 'axios';\n// import { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\n// const store = useStore()\n\nexport default {\n  __name: 'userMyBooks',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const user_name = ref('');\n    const First_Name = ref('');\n    const items_requested_book = ref([]);\n\n    // computed property to sort the items_requested_book array\n    const sortedItemsRequestedBook = computed(() => {\n      const requested = [];\n      const approved = [];\n      const returned = [];\n      const rejected = [];\n      items_requested_book.value.forEach(request => {\n        if (request.user_name === user_name.value) {\n          if (request.ReqStatus === 'Requested') {\n            requested.push(request);\n          } else if (request.ReqStatus === 'Approved') {\n            approved.push(request);\n          } else if (request.ReqStatus === 'Rejected') {\n            rejected.push(request);\n          } else if (request.ReqStatus === 'Returned') {\n            returned.push(request);\n          }\n        }\n      });\n      return [...requested, ...approved, ...rejected, ...returned];\n    });\n    function viewContent(Book_Title) {\n      router.push(`/viewContent/${Book_Title}`);\n    }\n    function returnBook(requestId) {\n      if (window.confirm(\"Do you really want to return this Book ?\")) {\n        const url = `http://127.0.0.1:5000/book_request/${requestId}`;\n        const data = {\n          'ReqStatus': 'Returned'\n        };\n        const token = localStorage.getItem('token');\n\n        // Set up Axios with the token in the headers\n        const axiosInstance = axios.create({\n          baseURL: 'http://127.0.0.1:5000',\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        try {\n          axiosInstance.patch(url, data).then(res => {\n            console.log(res);\n            window.location.reload();\n          });\n        } catch (error) {\n          console.error('Error fetching Data:', error);\n        }\n      } else {// Do Nothing\n      }\n    }\n    function fetchRequestedData() {\n      const storedData1 = localStorage.getItem('First_Name');\n      if (storedData1) {\n        First_Name.value = JSON.parse(storedData1);\n      } else {\n        router.push('/loginPage');\n      }\n      // For user name from local storage\n      const storedData2 = localStorage.getItem('user_name');\n      if (storedData2) {\n        user_name.value = JSON.parse(storedData2);\n      } else {\n        router.push('/loginPage');\n      }\n      const url = `http://127.0.0.1:5000/book_request`;\n      const token = localStorage.getItem('token');\n      // Set up Axios with the token in the headers\n      const axiosInstance = axios.create({\n        baseURL: 'http://127.0.0.1:5000',\n        // Your API server's URL\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      try {\n        axiosInstance.get(url).then(res => {\n          console.log(res);\n          items_requested_book.value = res.data.bookReq;\n        });\n      } catch (error) {\n        console.error('Error fetching Data:', error);\n      }\n    }\n    function redirectToHome() {\n      router.push(`/userDash`);\n    }\n    function userFeedback() {\n      router.push(`/userFeedback`);\n    }\n    function Logout() {\n      localStorage.clear();\n      router.push(`/loginPage/`);\n    }\n    onMounted(() => {\n      fetchRequestedData();\n    });\n    const __returned__ = {\n      router,\n      user_name,\n      First_Name,\n      items_requested_book,\n      sortedItemsRequestedBook,\n      viewContent,\n      returnBook,\n      fetchRequestedData,\n      redirectToHome,\n      userFeedback,\n      Logout,\n      onMounted,\n      ref,\n      computed,\n      get axios() {\n        return axios;\n      },\n      get useRouter() {\n        return useRouter;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","computed","axios","useRouter","router","user_name","First_Name","items_requested_book","sortedItemsRequestedBook","requested","approved","returned","rejected","value","forEach","request","ReqStatus","push","viewContent","Book_Title","returnBook","requestId","window","confirm","url","data","token","localStorage","getItem","axiosInstance","create","baseURL","headers","patch","then","res","console","log","location","reload","error","fetchRequestedData","storedData1","JSON","parse","storedData2","get","bookReq","redirectToHome","userFeedback","Logout","clear"],"sources":["/Users/apsg/JANMAD2/elibrary/src/components/userMyBooks.vue"],"sourcesContent":["<template>\n    <nav class=\"navbar navbar-expand-lg navbar-light bg-darkblue\">\n        <h4 class=\"navbar-brand\" href=\"#\">{{ First_Name }}'s Books Current Status</h4>      \n        <div class=\"navbar\" id=\"navbarNav\">\n            <ul class=\"navbar-nav\">\n\n                <li class=\"navbar-button\">\n                    <button type=\"navbar-button\" class=\"btn btn-primary\" @click=\"redirectToHome\">Home</button>\n                </li>\n\n                <li class=\"navbar-button\">\n                    <button type=\"navbar-button\" class=\"btn btn-primary\" @click=\"Logout\">Logout</button>\n                </li>\n            </ul>\n        </div>\n    </nav>    <hr style=\"border: 5px solid #4169E1;\">\n    <div style=\"margin-bottom: 20px;\">\n    <hr style=\"border: 5px solid #4169E1;\">\n    <hr style=\"border: 5px solid #4169E1;\">\n    <div v-for=\"request in sortedItemsRequestedBook\" :key=\"request.id\" style=\"margin-bottom: 20px; display: flex; align-items: center;\">\n        <h5 style=\"font-weight: bold; color: #4169E1; flex:1;\">\n            Section: {{ request.Section_Title }} &nbsp;|&nbsp;&nbsp;&nbsp; Book: {{ request.Book_Title }} &nbsp;|&nbsp;&nbsp;&nbsp; User: {{ request.user_name }} &nbsp;|&nbsp;&nbsp;&nbsp; No. of Days Requested: {{ request.Ndays }}\n        </h5>\n        \n        <div v-if=\"request.ReqStatus === 'Requested'\">\n        <button style=\"margin-right: 10px;\" :class=\"{ 'btn': true, 'btn-warning': request.ReqStatus === 'Requested', }\">Requested</button></div>\n        <div v-else-if=\"request.ReqStatus === 'Approved'\">\n            <button class=\"btn btn-outline-info\" style=\"margin-right: 10px;\" @click=\"viewContent(request.Book_Title)\">View Content</button>\n            <button class=\"btn btn-outline-danger\" style=\"margin-right: 10px;\" @click=\"returnBook(request.id)\">Return</button>\n            <button class=\"btn btn-outline-info\" style=\"margin-right: 10px;\" @click=\"userFeedback()\">Feedback</button>\n        </div>\n        <div v-else-if=\"request.ReqStatus === 'Returned'\">\n            <button class=\"btn btn-info\" style=\"margin-right: 10px;\">Returned</button>\n            <button class=\"btn btn-outline-info\" style=\"margin-right: 10px;\" @click=\"userFeedback()\">Feedback</button>\n        </div>\n        <div v-else>\n            <button class=\"btn btn-danger\" style=\"margin-right: 10px;\">Rejected</button>\n        </div>\n        <hr style=\"border: 10px solid #4169E1;\">\n    </div>\n    <hr style=\"border: 10px solid #4169E1;\"> <!-- Horizontal rule after each iteration -->\n</div>\n\n</template>\n\n<script setup>\nimport { onMounted, ref,computed } from 'vue';\nimport axios from 'axios';\n// import { useStore } from 'vuex';\nimport { useRouter } from 'vue-router';\n// const store = useStore()\nconst router = useRouter();\n\nconst user_name = ref('')\nconst First_Name =ref('')\nconst items_requested_book = ref([]);\n\n\n// computed property to sort the items_requested_book array\nconst sortedItemsRequestedBook = computed(() => {\n    const requested = [];\n    const approved = [];\n    const returned= [];\n    const rejected=[];\n    \n    items_requested_book.value.forEach(request => {\n        if (request.user_name === user_name.value){\n        if (request.ReqStatus === 'Requested') {\n            requested.push(request);\n        } else if(request.ReqStatus === 'Approved'){\n            approved.push(request);\n        }else if(request.ReqStatus === 'Rejected'){\n            rejected.push(request);\n        }else if(request.ReqStatus === 'Returned'){\n            returned.push(request);\n        }\n    }\n    });\n\n    return [...requested, ...approved,...rejected,...returned];\n});\n\nfunction viewContent(Book_Title){\n router.push(`/viewContent/${Book_Title}`)\n}\n\nfunction returnBook(requestId){\n    if (window.confirm(\"Do you really want to return this Book ?\")){\n    const url = `http://127.0.0.1:5000/book_request/${requestId}`;\n    const data = {'ReqStatus': 'Returned'};\n    const token = localStorage.getItem('token');\n\n    // Set up Axios with the token in the headers\n    const axiosInstance = axios.create({\n        baseURL: 'http://127.0.0.1:5000',\n        headers: {\n            'Authorization': `Bearer ${token}`\n        }\n    });\n\n    try {\n        axiosInstance.patch(url, data).then((res) => {\n            console.log(res);\n            window.location.reload();\n        });\n    } catch (error) {\n        console.error('Error fetching Data:', error);\n    }} else { // Do Nothing\n    }\n}\n\nfunction fetchRequestedData() {\n    const storedData1 = localStorage.getItem('First_Name');\n    if (storedData1) {\n        First_Name.value = JSON.parse(storedData1);\n    }\n    else{ router.push('/loginPage')}\n     // For user name from local storage\n    const storedData2 = localStorage.getItem('user_name');\n    if (storedData2) {\n        user_name.value = JSON.parse(storedData2);\n    }else{ router.push('/loginPage')}\n\n    const url = `http://127.0.0.1:5000/book_request`;\n    \n    const token = localStorage.getItem('token');\n    // Set up Axios with the token in the headers\n    const axiosInstance = axios.create({\n        baseURL: 'http://127.0.0.1:5000', // Your API server's URL\n        headers: {\n            'Authorization': `Bearer ${token}`\n        }\n    });\n    try {\n      axiosInstance.get(url).then((res) => {\n        console.log(res)\n        items_requested_book.value=res.data.bookReq\n      })\n    }\n    catch (error) {\n      console.error('Error fetching Data:', error);\n    }\n}\n\nfunction redirectToHome() {\n    router.push(`/userDash`)\n}\nfunction userFeedback() {\n    router.push(`/userFeedback`)\n}\nfunction Logout() {\n    localStorage.clear();\n    router.push(`/loginPage/`)\n}\n\nonMounted(() => {\n   fetchRequestedData()\n  \n});\n\n</script>\n\n<style  scoped>\n.navbar {\n    display: flex;\n    /* Ensure items are in a row */\n    justify-content: space-between;\n    /* Push items to the ends of the container */\n    align-items: center;\n    /* Vertically center items if needed */\n    text-align: center;\n    padding: 10px;\n    /* Add padding as needed */\n    /* background-color: #333; Change background color if needed */\n    color: #fff\n        /*Change text color if needed */\n}\n\n.navbar-brand {\n    text-align: center;\n    /* Center-align the text within the navbar */\n    flex-grow: 1;\n    /* Allow the name to expand and take available space */\n    margin: 0;\n    /* Remove any default margin */\n    /* font-family: 'Arial', sans-serif;  */\n    font-size: 32px;\n    font-weight: bold;\n    color: #4169E1;\n}\n\n.navbar-button {\n    margin-left: 10px;\n    /* Add spacing between buttons */\n    color: #166295;\n    /* Additional button styles like background color, text color, etc. */\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}